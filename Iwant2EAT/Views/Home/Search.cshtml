@model List<Iwant2EAT.Models.Store>
@Layout@{
    ViewBag.Title = "Search | EEEaTTT";
    ViewBag.HomeActive = "active";
    Layout = "/Views/Shared/_Layout.cshtml";
}

<div id="msgDiv">
    @(new HtmlString(ViewBag.SearchHtml))
</div>

<ul class="nav nav-pills nav-justified">
    <li role="presentation" class="@ViewBag.Name"><a href="@Url.Action("Search", new { Keyword = ViewBag.Keyword, Findway = "Name" })">店家名稱 <span class="badge">@ViewBag.NameCount</span></a></li>
    <li role="presentation" class="@ViewBag.Branch"><a href="@Url.Action("Search", new { Keyword = ViewBag.Keyword, Findway = "Branch" })">分店名稱 <span class="badge">@ViewBag.BranchCount</span></a></li>
    <li role="presentation" class="@ViewBag.Type"><a href="@Url.Action("Search", new { Keyword = ViewBag.Keyword, Findway = "Type" })">用餐類型 <span class="badge">@ViewBag.TypeCount</span></a></li>
    <li role="presentation" class="@ViewBag.Address"><a href="@Url.Action("Search", new { Keyword = ViewBag.Keyword, Findway = "Address" })">地址 <span class="badge">@ViewBag.AddressCount</span></a></li>
</ul>
<hr />
<div class="row">
    @for (int i = 0; Model != null && i < Model.Count; i++)
    {
        <div class="col-xs-12 col-sm-6 col-md-3">
            <div class="thumbnail">
                <img data-src="holder.js/100%x200" alt="100%x200" style="height: 300px; width: 100%; display: block;" src="@Model[i].ImageUrl" data-holder-rendered="true">
                <div class="caption">
                    <div style="float: left;">
                        <h3><strong>@Model[i].Name</strong><small>@(string.IsNullOrEmpty(@Model[i].Branch) ? "" : string.Format(" ({0})", @Model[i].Branch))</small></h3>
                    </div>
                    <div style="float: right;">
                        @if (Session["Username"] != null)
                        {
                            if (Model[i].Collect)
                            {
                                <a href="@Url.Action("Collect", "Store", new { Guid = Model[i].Guid, Collect = false, Rurl = "Home/Index"})" class="btn btn-primary" style="text-align: right">
                                    <img src="~/Content/Resources/star.png" width="30" height="30" style="display: inline-block;" />
                                    <span class="badge"> @Model[i].CollectCount</span>
                                </a>
                            }
                            else
                            {
                                <a href="@Url.Action("Collect", "Store", new { Guid = Model[i].Guid, Collect = true, Rurl = "Home/Index"})" class="btn btn-default" style="text-align: right">
                                    <img src="~/Content/Resources/star_empty.png" width="30" height="30" style="display: inline-block;" />
                                    <span class="badge"> @Model[i].CollectCount</span>
                                </a>
                            }
                        }
                    </div>
                    <table class="table table-striped" style="width: 100%;">
                        <tbody>
                            <tr>
                                <td width="20%">用餐類型</td>
                                <td width="80%">@Model[i].Type</td>
                            </tr>
                            <tr>
                                <td width="20%">聯絡電話</td>
                                <td width="80%">@Model[i].Phone</td>
                            </tr>
                            <tr>
                                <td width="20%">地址</td>
                                <td width="80%"><a href="https://www.google.com.tw/maps/place/@Model[i].Address" target="_blank">@Model[i].Address</a></td>
                            </tr>
                            <tr>
                                <td width="20%">營業時間</td>
                                <td width="80%">@(string.Format("{0} - {1}", @Model[i].OpeningTime.ToString(@"hh\:mm"), @Model[i].ClosingTime.ToString(@"hh\:mm")))</td>
                            </tr>
                            <tr>
                                <td width="20%">本日公休</td>
                                <td width="80%">
                                    @if (@Model[i].DayOff.Contains(ViewBag.DayOfWeek))
                                    {
                                        <span style="color: red">是</span>
                                    }
                                    else
                                    {
                                        <span>否</span>
                                    }
                                </td>

                            </tr>
                            <tr>
                                <td width="20%">店家介紹</td>
                                <td width="80%">
                                    @if (@Model[i].Introduction.Length > 20)
                                    {
                                        @(@Model[i].Introduction.Remove(20) + " ...")
                                        <a href="@Url.Action("Detail", "Store", new { Guid = @Model[i].Guid })">More</a>
                                    }
                                        else
                                        {
                                            @Model[i].Introduction
                                        }
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <p align="right">
                        <a href="@Url.Action("Detail", "Store", new { Guid = @Model[i].Guid })" class="btn btn-primary" role="button">Learn More</a>
                        @if (Session["Username"] != null)
                        {
                            if (Session["Username"].ToString().Equals(@Model[i].Creater))
                            {
                                <a href="@Url.Action("Modify", "Store", new { Guid = @Model[i].Guid })" class="btn btn-info" role="button">Modify Info</a>
                                <a href="@Url.Action("Delete", "Store", new { Guid = @Model[i].Guid })" class="btn btn-danger" role="button">Delete Store</a>
                            }
                        }
                    </p>
                </div>
            </div>
        </div>

        if (i != 0)
        {
            if (i % 2 == 1)
            {
                if (i % 4 == 3)
                {
                    <div class="clearfix"></div>
                }
                else
                {
                    <div class="clearfix visible-sm"></div>
                }
            }
        }
    }
</div>